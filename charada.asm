
; Tamanho da linha: 40
; Tamanho da coluna: 30
;

TelaInicial0:string  "########################################"
TelaInicial1:string  "#            ________                  #"
TelaInicial2:string  "#        _jgN########Ngg_              #"
TelaInicial3:string  "#      _N##N@@##  ##9NN##Np_           #"
TelaInicial4:string  "#     d###P            N####p          #"
TelaInicial5:string  "#     ####              T####          #"
TelaInicial6:string  "#                       d###P          #"
TelaInicial7:string  "#                    _g###@F           #"
TelaInicial8:string  "#                 _gN##@P              #"
TelaInicial9:string  "#               gN###F#                #"
TelaInicial10:string "#              d###F                   #"
TelaInicial11:string "#             0###F                    #"
TelaInicial12:string "#             0###F                    #"
TelaInicial13:string "#             0###F                    #"
TelaInicial14:string "#             #NN@'                    #"
TelaInicial15:string "#                                      #"
TelaInicial16:string "#              ___                     #"
TelaInicial17:string "#             q###r                    #"
TelaInicial18:string "#              ##                      #"
TelaInicial19:string "#                                      #"
TelaInicial20:string "#        JOGO DO ENIGMA                #"
TelaInicial21:string "#                                      #"
TelaInicial22:string "########################################"

TelaEmbaixo0:string "########################################"
TelaEmbaixo1:string "#                                      #"
TelaEmbaixo2:string "#                                      #"
TelaEmbaixo3:string "#       [SPACE] PARA CONTINUAR         #"
TelaEmbaixo4:string "#                                      #"
TelaEmbaixo5:string "#                                      #"
TelaEmbaixo6:string "########################################"

RespostaBanner0:string "########################################"
RespostaBanner1:string "#                                      #"
RespostaBanner2:string "#                                      #"
RespostaBanner3:string "#  RESPOSTA :                          #"
RespostaBanner4:string "#                                      #"
RespostaBanner5:string "#                                      #"
RespostaBanner6:string "########################################"


; CHARADAS

PrimeiraCharada0:string  "########################################"
PrimeiraCharada1:string  "#                                      #"
PrimeiraCharada2:string  "#                                      #"
PrimeiraCharada3:string  "#     VAMOS COMECAR COM UMA FACIL :)   #"
PrimeiraCharada4:string  "#                                      #"
PrimeiraCharada5:string  "#     POSSO SER MEMBRO DE UM GRUPO,    #"
PrimeiraCharada6:string  "#     MAS NAO CONSIGO ME MISTURAR.     #"
PrimeiraCharada7:string  "#                                      #"
PrimeiraCharada8:string  "#     O QUE EU SOU?                    #"
PrimeiraCharada9:string  "#                                      #"
PrimeiraCharada10:string "#                                      #"
PrimeiraCharada11:string "#                                      #"
PrimeiraCharada12:string "#                                      #"
PrimeiraCharada13:string "#                                      #"
PrimeiraCharada14:string "#                                      #"
PrimeiraCharada15:string "#                                      #"
PrimeiraCharada16:string "#                                      #"
PrimeiraCharada17:string "#                                      #"
PrimeiraCharada18:string "#                                      #"
PrimeiraCharada19:string "#                                      #"
PrimeiraCharada20:string "#                                      #"
PrimeiraCharada21:string "#                                      #"
PrimeiraCharada22:string "########################################"

SegundaCharada0:string   "########################################"
SegundaCharada1:string   "#                                      #"
SegundaCharada2:string   "#                                      #"
SegundaCharada3:string   "#    LEVE COMO UMA PENA, MAS NINGUEM   #"
SegundaCharada4:string   "#    PODE SEGURAR POR MUITO TEMPO.     #"
SegundaCharada5:string   "#                                      #"
SegundaCharada6:string   "#    O QUE EU SOU?                     #"
SegundaCharada7:string   "#                                      #"
SegundaCharada8:string   "#                                      #"
SegundaCharada9:string   "#                                      #"
SegundaCharada10:string  "#                                      #"
SegundaCharada11:string  "#                                      #"
SegundaCharada12:string  "#                                      #"
SegundaCharada13:string  "#                                      #"
SegundaCharada14:string  "#                                      #"
SegundaCharada15:string  "#                                      #"
SegundaCharada16:string  "#                                      #"
SegundaCharada17:string  "#                                      #"
SegundaCharada18:string  "#                                      #"
SegundaCharada19:string  "#                                      #"
SegundaCharada20:string  "#                                      #"
SegundaCharada21:string  "#                                      #"
SegundaCharada22:string  "########################################"

TerceiraCharada0:string  "########################################"
TerceiraCharada1:string  "#                                      #"
TerceiraCharada2:string  "#                                      #"
TerceiraCharada3:string  "#    INSISTE EM ME IGNORAR E           #"
TerceiraCharada4:string  "#    FINALMENTE QUANDO ME VOU,         #"
TerceiraCharada5:string  "#    VOCE LUTA PARA ME TER             #"
TerceiraCharada6:string  "#    DE VOLTA.                         #"
TerceiraCharada7:string  "#                                      #"
TerceiraCharada8:string  "#    Quem eu sou?                      #"
TerceiraCharada9:string  "#                                      #"
TerceiraCharada10:string "#                                      #"
TerceiraCharada11:string "#                                      #"
TerceiraCharada12:string "#                                      #"
TerceiraCharada13:string "#                                      #"
TerceiraCharada14:string "#                                      #"
TerceiraCharada15:string "#                                      #"
TerceiraCharada16:string "#                                      #"
TerceiraCharada17:string "#                                      #"
TerceiraCharada18:string "#                                      #"
TerceiraCharada19:string "#                                      #"
TerceiraCharada20:string "#                                      #"
TerceiraCharada21:string "#                                      #"
TerceiraCharada22:string "########################################"

QuartaCharada0:string  "########################################"
QuartaCharada1:string  "#                                      #"
QuartaCharada2:string  "#    O QUE HA EM NENHUMA PARTE         #"
QuartaCharada3:string  "#    MAS EM TODOS OS LUGARES,          #"
QuartaCharada4:string  "#    EXCETO QUANDO ALGO EH?            #"
QuartaCharada5:string  "#                                      #"
QuartaCharada6:string  "#                                      #"
QuartaCharada7:string  "#                                      #"
QuartaCharada8:string  "#                                      #"
QuartaCharada9:string  "#                                      #"
QuartaCharada10:string "#                                      #"
QuartaCharada11:string "#                                      #"
QuartaCharada12:string "#                                      #"
QuartaCharada13:string "#                                      #"
QuartaCharada14:string "#                                      #"
QuartaCharada15:string "#                                      #"
QuartaCharada16:string "#                                      #"
QuartaCharada17:string "#                                      #"
QuartaCharada18:string "#                                      #"
QuartaCharada19:string "#                                      #"
QuartaCharada20:string "#                                      #"
QuartaCharada21:string "#                                      #"
QuartaCharada22:string "########################################"

QuintaCharada0:string  "########################################"
QuintaCharada1:string  "#                                      #"
QuintaCharada2:string  "#                                      #"
QuintaCharada3:string  "#    POSSO TRAZER LAGRIMAS EM SEU      #"
QuintaCharada4:string  "#    ROSTO, SOU CRIADO EM UM INSTANTE  #"
QuintaCharada5:string  "#    MAS DURO A VIDA TODA.             #"
QuintaCharada6:string  "#                                      #"
QuintaCharada7:string  "#    O QUE EU SOU?                     #"
QuintaCharada8:string  "#                                      #"
QuintaCharada9:string  "#                                      #"
QuintaCharada10:string "#                                      #"
QuintaCharada11:string "#                                      #"
QuintaCharada12:string "#                                      #"
QuintaCharada13:string "#                                      #"
QuintaCharada14:string "#                                      #"
QuintaCharada15:string "#                                      #"
QuintaCharada16:string "#                                      #"
QuintaCharada17:string "#                                      #"
QuintaCharada18:string "#                                      #"
QuintaCharada19:string "#                                      #"
QuintaCharada20:string "#                                      #"
QuintaCharada21:string "#                                      #"
QuintaCharada22:string "########################################"

SextaCharada0:string  "########################################"
SextaCharada1:string  "#                                      #"
SextaCharada2:string  "#                                      #"
SextaCharada3:string  "#    POSSO OCUPAR UMA SALA OU          #"
SextaCharada4:string  "#    APENAS UM CORACAO.                #"
SextaCharada5:string  "#    OUTROS PODEM ME TER,              #"
SextaCharada6:string  "#    MAS NAO POSSO SER DIVIDIDO.       #"
SextaCharada7:string  "#                                      #"
SextaCharada8:string  "#    O QUE EU SOU?                     #"
SextaCharada9:string  "#                                      #"
SextaCharada10:string "#                                      #"
SextaCharada11:string "#                                      #"
SextaCharada12:string "#                                      #"
SextaCharada13:string "#                                      #"
SextaCharada14:string "#                                      #"
SextaCharada15:string "#                                      #"
SextaCharada16:string "#                                      #"
SextaCharada17:string "#                                      #"
SextaCharada18:string "#                                      #"
SextaCharada19:string "#                                      #"
SextaCharada20:string "#                                      #"
SextaCharada21:string "#                                      #"
SextaCharada22:string "########################################"

SetimaCharada0:string  "########################################"
SetimaCharada1:string  "#                                      #"
SetimaCharada2:string  "#                                      #"
SetimaCharada3:string  "#  EU SOU AREIA NA AGUA, MAS SE A AGUA #"
SetimaCharada4:string  "#  ME TOCA EU MORRO.                   #"
SetimaCharada5:string  "#                                      #"
SetimaCharada6:string  "#  O QUE EU SOU?                       #"
SetimaCharada7:string  "#                                      #"
SetimaCharada8:string  "#                                      #"
SetimaCharada9:string  "#                                      #"
SetimaCharada10:string "#                                      #"
SetimaCharada11:string "#                                      #"
SetimaCharada12:string "#                                      #"
SetimaCharada13:string "#                                      #"
SetimaCharada14:string "#                                      #"
SetimaCharada15:string "#                                      #"
SetimaCharada16:string "#                                      #"
SetimaCharada17:string "#                                      #"
SetimaCharada18:string "#                                      #"
SetimaCharada19:string "#                                      #"
SetimaCharada20:string "#                                      #"
SetimaCharada21:string "#                                      #"
SetimaCharada22:string "########################################"


TelaFim0:string  "########################################"
TelaFim1:string  "#     _   __    _  _  _  _  _          #"
TelaFim2:string  "#    / \ /  |_||_||_)|_|| \|_|         #"
TelaFim3:string  "#    \_/ \__| || || \| ||_/| |         #"
TelaFim4:string  "#     __ _        _                    #"
TelaFim5:string  "#    /__|_||\||_|/ \| |                #"
TelaFim6:string  "#    \_|| || || |\_/|_|                #"
TelaFim7:string  "#                                      #"
TelaFim8:string  "#                                      #"
TelaFim9:string  "#    O /                               #"
TelaFim10:string "#     (                                #"
TelaFim11:string "#    O \                               #"
TelaFim12:string "#                                      #"
TelaFim13:string "#                                      #"
TelaFim14:string "#                                      #"
TelaFim15:string "#                                      #"
TelaFim16:string "#                                      #"
TelaFim17:string "#                                      #"
TelaFim18:string "#                                      #"
TelaFim19:string "#                                      #"
TelaFim20:string "#                                      #"
TelaFim21:string "#                                      #"
TelaFim22:string "########################################"

PrimeiraCharadaResposta: string "individuo"
SegundaCharadaResposta: string "folego"
TerceiraCharadaResposta: string "tempo"
QuartaCharadaResposta: string "nada"
QuintaCharadaResposta: string "memoria"
SextaCharadaResposta: string "solidao"
SetimaCharadaResposta: string "sal"

TelaFimResposta: string "eu"

FIM: string "FIM"

LetraInstrucao:var #1
Resposta:var #40
RespostaCorreta: var #1
DONE: string "Done."

main:
	
	loadn r1, #TelaInicial0
	loadn r6, #23 ; tamanho da tela
	loadn r2, #512 ; COR Verde
	loadn r0, #0
	call imprime_tela
	
	loadn r0, #23
	loadn r1, #TelaEmbaixo0
	loadn r2, #1280
	loadn r6, #7
	call imprime_tela

	call AguardaEspaco
	call IniciarJogo
	
	
	halt




; Iniciar Jogo
IniciarJogo:
	push r1
	push r2
	
	loadn r1, #PrimeiraCharada0
	loadn r2, #PrimeiraCharadaResposta
	call comecar_charada
	
	; EXEMPLOS DE COMO USAR O PROGRAMA 
	
	loadn r1, #SegundaCharada0
	loadn r2, #SegundaCharadaResposta
	call comecar_charada
	
	loadn r1, #TerceiraCharada0
	loadn r2, #TerceiraCharadaResposta
	call comecar_charada
	
	
	loadn r1, #QuartaCharada0
	loadn r2, #QuartaCharadaResposta
	call comecar_charada
	
	loadn r1, #QuintaCharada0
	loadn r2, #QuintaCharadaResposta
	call comecar_charada
	
	loadn r1, #SextaCharada0
	loadn r2, #SextaCharadaResposta
	call comecar_charada
	
	loadn r1, #SetimaCharada0
	loadn r2, #SetimaCharadaResposta
	call comecar_charada
	
	pop r2
	pop r1
	rts



; comecar_charada
; r1 -> Charada Banner
; r2 -> Resposta Correta
comecar_charada:
	call imprime_charada
	call aguarda_resposta
	call verifica_resposta	
	rts



; VERIFICA RESPOSTA
verifica_resposta:
	push r1
	push r2
	push r3
	push r5
	
	load r1, Resposta
	call compara_strings
	
	load r1, RespostaCorreta
	loadn r2, #1
	cmp r1, r2
	cne resposta_errada_fim
	
	
	pop r5
	pop r3
	pop r2
	pop r1
	rts


resposta_errada_fim:
	push r1
	push r2
	push r0
	
	loadn r1, #TelaFim0
	loadn r2, #2304
	loadn r6, #23
	loadn r0, #0
	call imprime_tela
	
	halt 
	pop r2
	pop r1
	pop r0
	rts


; AGUARDA A RESPOSTA
aguarda_resposta:
	push r0
	push r1
	push r2
	push r3

	loadn r0, #1054
	loadn r2, #' '
	load r3, Resposta

aguarda_resposta_loop:
	call getchar
	load r1, LetraInstrucao
	cmp r1, r2
	jeq aguarda_resposta_fim
	outchar r1, r0
	storei r3, r1
	inc r0
	inc r3
	jmp aguarda_resposta_loop


aguarda_resposta_fim:
	loadn r0, #'\0'
	storei r3, r0
	pop r3
	pop r2
	pop r1
	pop r0
	rts

; IMPRIME CHARADA
; r1 -> InicioDaCharad0
; tamanho padrao -> 23
; cor padrao -> verde -> 512

imprime_charada:
	push r0
	push r1
	push r2
	push r6
	
	loadn r0, #0
	loadn r2, #512
	loadn r6, #23
	call imprime_tela

	loadn r0, #23
	loadn r1, #RespostaBanner0
	loadn r2, #1280
	loadn r6, #7
	call imprime_tela
	
	pop r6
	pop r2
	pop r1
	pop r0
	rts




; Funcao aguardar espaco

AguardaEspaco:
	call getchar
	load r0, LetraInstrucao
	loadn r1, #' '
	cmp r0, r1
	jne AguardaEspaco
	rts





; Funcoes auxiliares

getchar:
	push r0
	push r1
	loadn r1, #255

getchar_loop:
	inchar r0
	cmp r0, r1
	jeq getchar_loop

getchar_fim:
	store LetraInstrucao, r0
	pop r1
	pop r0
	rts


; - - - - Funcao imprime tela - - - -
;	r0 -> linha onde o desenho comeca na tela	
;	r1 -> ponteiro do inicio do desenho
;	r2 -> cor do desenho
;	r6 -> numero de linhas que o desenho usa
;

imprime_tela:
	push r0
	push r1
	push r2
	push r3
	push r4
	push r5
	push r6
	
	loadn r3, #40 ; incremento de 40 pois cada linha tem 40 caracteres
	loadn r4, #41
	mul r0, r0, r3
	mul r5, r6, r3 ; fim do desenho
	add r5, r5, r0

imprime_tela_loop:
	call imprime_string
	add r0, r0, r3
	add r1, r1, r4
	cmp r0, r5
	jne imprime_tela_loop

imprime_tela_fim:
	pop r6
	pop r5
	pop r4
	pop r3
	pop r2
	pop r1
	pop r0
	rts


; Compara strings
; r1 -> string1
; r2 -> string2

compara_strings:
	push r1
	push r2

	push r3
	push r4
	
	push r5
	loadn r5, #'\0'

compara_strings_loop:
	loadi r3, r1
	loadi r4, r2
	
	cmp r3, r4
	jne compara_falso
	
	cmp r3, r5
	jeq compara_true
	
	inc r1
	inc r2
	jmp compara_strings_loop
	

compara_falso:
	loadn r1, #0
	store RespostaCorreta, r1
	jmp compara_fim_loop

compara_true:
	loadn r1, #1
	store RespostaCorreta, r1
	jmp compara_fim_loop

compara_fim_loop:
	pop r5
	pop r4
	pop r3
	pop r2
	pop r1
	rts





; print done
print_done:
	push r1
	push r0
	push r2
	
	loadn r1, #DONE
	loadn r0, #0
	loadn r2, #0
	call imprime_string
	
	pop r2
	pop r1
	pop r0



; Imprime string
imprime_string:
	push r0
	push r1
	push r2
	push r3
	push r4
	
	loadn r3, #'\0'

imprime_string_loop:
	loadi r4, r1
	cmp r4, r3
	jeq imprime_string_fim
	add r4, r2, r4
	outchar r4, r0
	inc r0
	inc r1
	jmp imprime_string_loop

imprime_string_fim:
	pop r4
	pop r3
	pop r2
	pop r1
	pop r0
	rts
	
	
